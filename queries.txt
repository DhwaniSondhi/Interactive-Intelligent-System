PREFIX dbr: <http://dbpedia.org/resource/>
prefix dbp: <http://dbpedia.org/property/> 
prefix dbr: <http://dbpedia.org/resource/> 
prefix dc: <http://purl.org/dc/elements/1.1/> 
prefix foaf: <http://xmlns.com/foaf/0.1/> 
prefix isp: <http://intelligentsystemproj1.io/schema#> 
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> 
prefix xml: <http://www.w3.org/XML/1998/namespace> 
prefix xsd: <http://www.w3.org/2001/XMLSchema#> 


#Q1)Count the no of triples
SELECT (COUNT(*) as ?Triples) 
WHERE { 
?s ?p ?o
}

#Q2)Count the number of students, courses, topics
SELECT  
(COUNT(DISTINCT ?students) as ?scount)
(COUNT(DISTINCT ?courses) as ?ccount)
(COUNT(DISTINCT ?t) as ?tcount)

WHERE{

  ?students rdf:type dbr:Student .
  ?courses rdf:type dbr:Course .
  ?k dc:hasPart ?x.
  ?x foaf:name ?t.
 }

#Q3)For a course c, list all covered topics using their (English) labels and their link to DBpedia
SELECT ?topic
WHERE{
  ?course rdf:type dbr:Course .
  ?course foaf:name ?name .
  ?course foaf:name "Machine Learning".
  ?course dc:hasPart ?x.
  ?x foaf:name ?topic.
 }
 
#Q4. For a given student, list all courses this student completed, together with the grade

SELECT ?fn ?score ?coursename
WHERE { 
?s rdf:type dbr:Student;
 foaf:familyName ?ln;
 foaf:givenName ?fn ;
 foaf:mbox ?mb;
 dc:identifier "40083896"^^xsd:int.
?s foaf:topic_interest ?gradeobject .
?gradeobject   dbp:score ?score ;
    dc:subject ?courseobject .
?courseobject foaf:name ?coursename
}

#Q5. For a given topic, list all students that are familiar with the topic (i.e., took, and did not fail, acourse that covered the topic)

SELECT ?fn ?coursename ?grade ?topicname
WHERE { 
?s rdf:type dbr:Student;
 foaf:familyName ?ln;
 foaf:givenName ?fn ;
 foaf:mbox ?mb;
 dc:identifier ?e.
 ?s foaf:topic_interest ?gradeobject.
 ?gradeobject dc:subject  ?courseobject .
 ?gradeobject dbp:score ?grade .
  ?courseobject foaf:name ?coursename.
  ?courseobject dc:hasPart ?topic.
  ?topic foaf:name ?topicname.
  ?topic foaf:name "CORBA".
  FILTER(?grade <"F")
} 

#Q6. For a student, list all topics (no duplicates) that this student is familiar with (based on the completedcourses for this student that are better than an \F" grade)

SELECT DISTINCT ?fn ?topicname ?coursename ?grade 
WHERE { 
?s rdf:type dbr:Student;
 foaf:familyName ?ln;
 foaf:givenName ?fn ;
 foaf:givenName "Michael" ;
 foaf:mbox ?mb;
 dc:identifier ?e.
 ?s foaf:topic_interest ?gradeobject.
 ?gradeobject dc:subject  ?courseobject .
 ?gradeobject dbp:score ?grade .
  ?courseobject foaf:name ?coursename.
  ?courseobject dc:hasPart ?topic.
  ?topic foaf:name ?topicname.
  FILTER(?grade <"F")
}  
 
 
 
#All students familiar with topic corba(pass and fail)

SELECT ?fn ?p ?t
WHERE { 
?s rdf:type dbr:Student;
 foaf:familyName ?ln;
 foaf:givenName ?fn ;
 foaf:mbox ?mb;
 dc:identifier ?e.
 ?s foaf:topic_interest ?something.
 ?something dc:subject  ?som .
  ?som foaf:name ?p.
  ?som dc:hasPart ?topic.
  ?topic foaf:name ?t.
  ?topic foaf:name "CORBA".
} 
 
#DISPLAY STUDENT DETAILS
SELECT *
WHERE { 
?s rdf:type dbr:Student.
?s foaf:familyName ?ln.
?s foaf:givenName ?fn  .
?s foaf:mbox ?mb  .
?s dc:identifier ?k  .
}


#all courses and its info
SELECT  *
WHERE{
  ?courses rdf:type dbr:Course .
  ?course 
    dc:description ?k ;
     dc:description ?a ;
    dc:identifier ?b ;
    dc:subject ?c ;
    rdfs:seeAlso ?d ;
    foaf:name ?e .
 }LIMIT 10